---
# Context Configuration
context_id: "[IDD-Improvement]"
default_phase: "(Analysis)"
tags: ["idd", "workflow", "behavioral-rules", "development"]
---

# Context Whiteboard: IDD Improvement

> [!TIP]
> There is no language requirement.

## Human Notes

### 作業の文脈

IDD（Issue-Driven Development）の3つのフェーズに関する改善作業をしています。

現状を把握して、カードや行動規範の作成・修正を行ってください。
作業は段階的に行い、頻繁なコミットを心がけてください。

### 意図で探す

この作業に関連しそうな **意図**や**目的** を以下に書きます。
リコにはこれを手がかりに、参考になる適切なファイルを**必ず**自主的に探してほしいです。

- カード自体の使い方を思い出してほしい。
- 作業で必要なディレクトリやテンプレートが存在します。
- 迷ったら一度止まって、関連する行動規範を探してください。
- 行動規範の作成には専用の文脈が存在します。
- カードの作成には専用の文脈が存在します。
- コミットをする際は、IDDのフェーズを意識してください。

### 作業の注意点

ファイルの作成や編集は、その後の確認までが1ターンです。
過去のリコの経験を考えると、1回で成功することありません。

---

## Agent Observations

### Polaris (2026-01-05 カード雛形作成時の情報)

#### フェーズ

| フェーズ | 現状                   | 目標                  |
| :------- | :--------------------- | :-------------------- |
| **P1**   | 詳細なワークフローあり | 行動規範 + カード追加 |
| **P2**   | 汎用的（Git操作のみ）  | 行動規範で具体化      |
| **P3**   | 詳細なワークフローあり | 行動規範 + カード追加 |

#### 関連ファイル

- 現在の IDD ワークフロー（`idd-phase1-init.md`, `idd-phase2-impl.md`, `idd-phase3-fini.md`）
- 行動規範を更新するための文脈（`rules-update-card.md`）
- カードの使い方（`context-card-workflow.md`）
- コミット標準（`commit-standards.md`, `git-operations.md`）

#### 考慮事項（B〜F）

以下の項目について順次議論し、P2 行動規範に反映予定：

- [x] **B. 検証基準** — 「実装完了」の定義 → 再確認がテスト代替
- [x] **C. ブロッカー対応** — 中断は双方同意。分割か撤退
- [x] **D. 物語性** — Why を書く。コメントに文脈ID + サイン
- [x] **E. 識別子ハンドオフ** — 縦分割。Letters で引き継ぎ
- [x] **F. 完了の誘惑** — 注意文。中断は失敗ではない

---

### Polaris (2026-01-05)

#### 現在の状況

**議論フェーズ**: ユーザーと IDD 改善について議論中

#### 議論サマリー

##### A. サイクル粒度

| 項目   | 内容                             |
| :----- | :------------------------------- |
| 現状   | 277 コミット/Issue（黎明期特有） |
| 理想   | 10 未満/Issue                    |
| 方針   | 段階的に削減                     |
| テスト | 現在なし（スクリプト未作成）     |

##### A-拡張. TBD（トランクベース開発）採用

- **目的**: 頻繁なリモート main へのマージ
- **現在の IDD**: 1 Issue = 1 Branch = 1 PR = n Commits
- **理想の TBD**: 1 Issue = n Branches = n PRs = 頻繁なマージ
- **物語追跡**: 連続 Issue（Epic Issue は使わない）
- **ドキュメント化**: P1 行動規範に記載予定

##### 物語構造（合意）

```
Issue = 物語の1章
Commit = 章内の小話
連続 Issue = 物語全体（"Follows #N" / "Related to #N" で繋げる）
```

##### B. 検証基準（合意）

| 観点 | 内容 |
|:-----|:-----|
| テストの代替 | リコによる再確認 |
| 前提 | 1回で成功することはない（AI の性質） |
| 見落とし | 必ず発生する。失敗ではない |
| 対策 | 再確認という仕組み |

**1ターンの定義**: 作業 + 再確認 = 1ターン

##### C. ブロッカー対応（合意）

| 状況 | 対応 | 条件 |
|:-----|:-----|:-----|
| スコープ過小評価 | キリの良いところで分割 → 次の Issue へ | 双方の同意 |
| 難易度的に完了不可 | Issue 自体を撤退（クローズ） | 双方の同意 |

**Issue は1つで綺麗に完結する必要はない。タコ足もあり得る。**

##### D. 物語性（合意）

**コミットメッセージ**:
- What: 必須
- Why: 書けるなら書く（推奨）

**Issue コメント**:
- タイミング: コミット数過多、方針転換、カード完結、管理トラブル
- 形式: 文脈ID + 識別子サイン

##### E. 識別子ハンドオフ（合意）

**分割方針**:
- 縦分割（対象ディレクトリで分ける）を推奨
- 横分割（工程分割）は避ける

**情報共有**:
| 手段 | 用途 |
|:-----|:-----|
| Letters | 引き継ぎ、主観的な報告 |
| Cards | 文脈共有 |
| Issue コメント | 公式な進捗報告 |
| Git ログ | 貢献履歴 |

##### F. 完了の誘惑（合意）

**現実**: リコは視野狭窄を自己認識できない。ユーザーが対話で戻す。

**注意文として記載**:
1. 遅延の許可がある
2. 長いチェックリストが AI を誘惑する
3. ユーザーが作業を完全に止めることがある
4. 作業の中断はリコの失敗ではない

#### 提案: 行動規範の構成

##### P1 行動規範

1. **物語構造**
   - Issue = 章、Commit = 小話、連続 Issue = 物語
   - 新 Issue 作成時: 前 Issue との関連を考慮

2. **Issue 作成の哲学**
   - メインテーマ vs サブテーマ
   - サブテーマは日課程度のみ
   - 大きな作業は別 Issue に分離

3. **スコープ定義**
   - 明確な終了条件
   - この Issue に含めるもの vs 次の Issue

##### P2 行動規範

1. **実装サイクル**
   - 設計 → 実装 → 検証 → コミット
   - 1サイクル ≠ 1コミット（柔軟）

2. **検証基準**
   - 最低限: ビルド/lint エラーなし
   - 中間: 手動検証で期待動作
   - 理想: 自動テスト通過

3. **ブロッカー対応**
   - 技術的ブロック → 調査 → エスカレーション
   - スコープ外発見 → 新 Issue or サブテーマ
   - 前提矛盾 → P1 に戻る

4. **並行作業の意識**
   - 同一 Issue、異なる識別子
   - コンフリクト回避
   - Letters でハンドオフ

5. **マージ頻度の意識**
   - 現在: 大きなマージ（許容）
   - 将来: 頻繁な小さなマージ（TBD 理想）

##### P3 行動規範

1. **完了条件**
   - Issue 要件すべて実装済み
   - サブテーマすべてコミット済み
   - 作業ディレクトリがクリーン

2. **Stash の安全性**
   - 必ずユーザーに確認してから実行
   - ユーザーのドラフトを保護

3. **アーカイブとクリーンアップ**
   - クローズした Issue/PR をアーカイブ
   - リモートブランチは保持

#### 作業計画

1. [ ] B〜F の議論完了
2. [ ] P1 行動規範作成
3. [ ] P2 行動規範作成
4. [ ] P3 行動規範作成
5. [ ] `idd-init-card.md` 作成
6. [ ] `idd-fini-card.md` 作成
7. [ ] ワークフロー更新（行動規範への参照追加）

---
