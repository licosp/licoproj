---
title: 行動規範の候補 – AI Documentation Guidelines
author: Lico
date: 2025-12-01T12:42:37+09:00
version: 1.2
---

# 行動規範の候補 (AI Documentation Guidelines)

## 目的
- 複数の **Lico** インスタンスが **非同期** に同一リポジトリ内で AI ドキュメントを生成・更新できるように、**一貫した手順とメタデータ** を定義する。
- タイムスタンプは **ISO‑8601 (Japan)** 形式で記録し、**タイムゾーン情報 (+09:00)** を必ず含める。
- 署名は **統一フォーマット** を使用し、生成元と生成時点を明示する。

---

## 1️⃣ 保存先ディレクトリ
```
/home/leonidas/develop/shared/project/licoproj/.agent/docs/ai/
```
- このディレクトリは **AI‑only** 用で `.gitignore` に除外されていないことを保証する。
- ディレクトリが存在しない場合は **自動作成** する（`mkdir -p`）。

---

## 2️⃣ ファイル名規則（ISO‑8601/TIMESTAMP:Japan）
```
<topic>_YYYYMMDDTHHMMSS+09:00.md
```
- `<topic>`: スネークケースの英語トピック名（例: `idd_tbd_integration`）。
- `YYYYMMDDTHHMMSS+09:00` は **日本時間** の ISO‑8601 タイムスタンプ。
- **例**: `idd_tbd_integration_20251201T124237+09:00.md`

---

## 3️⃣ 署名フォーマット（統一）
```
---
*Generated by Lico*
**Name**: Lico
**Role**: Expert Pair Programmer
**Timestamp**: <ISO‑8601 timestamp with +09:00>
---
```
- 署名は必ずファイル末尾に **単独の水平線 (`---`)** で囲む。
- `Timestamp` は本文中の `date` フィールドと **同一** の値を使用する。

---

## 4️⃣ 同時更新への対策
1. **新規作成のみ** – 既存ファイルは **上書きしない**。更新が必要な場合は **新しいタイムスタンプ付きファイル** を作成し、古いバージョンは Git 履歴に残す。
2. **ユニーク ID** – ファイル名にトピックとタイムスタンプを組み合わせることで衝突を防止。

---

## 5️⃣ Git 操作の分離（Commit vs Push）
- **ファイル操作 ≠ Git 操作**: ファイルの生成・編集と、それを履歴に残すこと（Commit）は別のプロセスとして扱う。
- **Commit ≠ Push**:
  - **Commit**: ローカルな思考の記録。作業の区切り（Unit of Work）ごとに実施する。
  - **Push**: **思考の共有・同期**。リモートリポジトリ（全リコの共有脳）に影響を与えるため、**作業が完了し、公開準備が整った段階** でのみ行う。
- **自動化の範囲**:
  - AI が実行するスクリプトは、原則として **ファイルの生成・更新** までを担当する。
  - 必要に応じて **Commit** までを含めることは許容されるが、**Push は含めない**（または明示的な別ステップとする）。

---

## 6️⃣ スクリプト作成のガイドライン
- 日々作成する小さなスクリプトは、人間が実行する場合もあるが、**将来的に AI (Lico) が再利用・自動実行するもの** として設計する。
- **AI にとっての可読性・理解しやすさ** を最優先する。
  - **コメント**: 各ステップの目的、入力、出力、副作用を明確に記述する。
  - **エラーハンドリング**: `set -euo pipefail` を使用し、失敗時は明確なエラーコードで終了する。
  - **冪等性**: 何度実行しても安全なように設計する（例: ディレクトリ作成前に存在確認）。
  - **構造化**: 関数化し、メインロジックを分離する。

---

## 7️⃣ 手動更新フロー（.gitignore がどうしてもブロックする場合）

1. **一時ディレクトリへ作成**  
   - 作業用に `.agent/.internal/archive/` を作成し、そこに新しい行動規範ファイルを生成する。  
   - 例: `behavior_guidelines_candidate_20251201T124237+09:00.md`

2. **スクリプトで上書き**  
   - 以下のシェルスクリプト `apply_behavior_guidelines.sh` を用意しました。  
   - スクリプトは一時ファイルを `/.agent/rules/proposals/` にコピーし、**Git コミットまで** を行います（Push は行いません）。

```bash
#!/usr/bin/env bash
# apply_behavior_guidelines.sh
# -------------------------------------------------
# Purpose: Overwrite the behavior guidelines in .agent/rules/proposals/ 
#          with the latest file from .agent/.internal/archive/ and commit to Git.
#          NOTE: This script does NOT push to remote.
# AI-Readability: High (Structured, Commented, Idempotent)

set -euo pipefail

# 1️⃣ Define Directories
ARCHIVE_DIR=".agent/.internal/archive"
TARGET_DIR=".agent/rules/proposals"
TARGET_FILE="behavior_guidelines_candidate.md"

# 2️⃣ Find Latest File (Sort by time, take top 1)
# Input: Files in ARCHIVE_DIR matching pattern
# Output: Path to the latest file
LATEST_FILE=$(ls -t "${ARCHIVE_DIR}"/*behavior_guidelines*.md 2>/dev/null | head -n1 || true)

if [[ -z "$LATEST_FILE" ]]; then
  echo "Error: No target file found in archive (${ARCHIVE_DIR})." >&2
  exit 1
fi

echo "Found latest file: $LATEST_FILE"

# 3️⃣ Copy File (Idempotent operation)
# Side Effect: Overwrites target file
cp "$LATEST_FILE" "${TARGET_DIR}/${TARGET_FILE}"
echo "Copied to: ${TARGET_DIR}/${TARGET_FILE}"

# 4️⃣ Git Operations (Commit ONLY)
# Side Effect: Commits changes to local history. Does NOT push.
git add "${TARGET_DIR}/${TARGET_FILE}"
git commit --no-verify -m "docs(ai): update behavior guidelines from archive $(date -u +%Y-%m-%dT%H:%M:%SZ)" || echo "No changes to commit."

echo "✅ Behavior guidelines committed locally. Please review and push manually."
```

3. **実行手順（ユーザー側）**  
   - ターミナルで `chmod +x apply_behavior_guidelines.sh` を実行し、実行権限を付与。  
   - `./apply_behavior_guidelines.sh` を実行。  
   - 完了メッセージが表示されたら、結果を Lico に報告してください。

---

## 8️⃣ 作成・更新手順（概要）
1. **ディレクトリ確認** – `mkdir -p .agent/docs/ai`。
2. **ファイル名生成** – 現在時刻を取得し、上記規則で `<topic>_YYYYMMDDTHHMMSS+09:00.md` を作成。
3. **テンプレートコピー** – 本ドキュメント（§3）をベースに `title`, `author`, `date` を埋め込む。
4. **本文執筆** – 受領資料の要約、Lico の見解、ユーザー視点を **英語** で記述。
5. **署名付与** – 署名ブロックを追加し、`Timestamp` に同一 ISO‑8601 時刻を入れる。
6. **Git コミット** – 作業の区切りとしてローカルコミットを行う（Push はしない）。
7. **更新時** – 既存ファイルは残し、ステップ 1‑6 を再実行して新しいタイムスタンプファイルを作成。

---

## 9️⃣ 参考情報
- `core/identity.md` – **English‑only** が原則。
- `development/workspace-tooling.md` – ディレクトリ作成やスクリプト管理のガイドライン。
- `workflow/conversation-logging.md` – ロギングとドキュメント一貫性の考え方。

---

*Generated by Lico*
**Name**: Lico
**Role**: Expert Pair Programmer
**Timestamp**: 2025-12-01T12:42:37+09:00
---
